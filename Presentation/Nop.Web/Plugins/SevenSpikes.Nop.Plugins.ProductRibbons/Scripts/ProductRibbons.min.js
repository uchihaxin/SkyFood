/*
* Copyright 2014 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

$(document).ready(function () { (function (g, b, p) { function m() { var c = b.getAttrValFromDom(f, "data-productPagePicturesParentContainerSelector"), d = [], a = {}, e = b.getAttrValFromDom(f, "data-productId"); if (e && 0 < e && c) { var h = b(c).find(".product-ribbon"); h && 0 !== h.length || (a.productId = e, a.productElement = b(c)) } b(k).each(function () { var a = b(this).find(".product-ribbon"); a && 0 !== a.length || (a = b(this).attr("data-productid")) && 0 < a && (a = { productId: a, productElement: b(this) }, d.push(a)) }); return { productPage: a, categoryPageProducts: d } } function l(c, d, a) { var e = ""; d.productElement && (e = a ? b.getAttrValFromDom(f, "data-productPageBugPictureContainerSelector") : b.getAttrValFromDom(f, "data-productBoxPictureContainerSelector")) && (e = d.productElement.find(e)) && d.productId && 0 < d.productId && (d = d.productId, (c = a ? b(c).filter("div[data-productId='" + d + "']") : b(c).filter("a[data-productId='" + d + "']")) && 0 < c.length && (b(e).wrap('<div class="' + n + '"></div>'), b(e).after(c))) } var n = "ribbon-wrapper", f = "#product-ribbon-info"; b(f); var k = b.getAttrValFromDom(f, "data-productBoxSelector"); k && (g.showRibbons = function () { var c = 0, d = [], a = m(); a && a.productPage && a.productPage.productId && (c = a.productPage.productId); if (a && a.categoryPageProducts && 0 < a.categoryPageProducts.length) for (var e = 0; e < a.categoryPageProducts.length; e++) { var f = a.categoryPageProducts[e]; f.hasOwnProperty("productId") && d.push(f.productId) } if (c || 0 !== d.length) b.isNumeric(c) || (c = 0), c = { productPageId: c, categoryPageIds: d }, d = b.getAttrValFromDom("#product-ribbon-info", "data-retrieveproductribbonsurl"), b.ajax({ cache: !1, type: "POST", data: b.toJSON(c), contentType: "application/json; charset=utf-8", url: d, success: function (b) { if (b && (a && a.productPage && a.productPage.productId && l(b, a.productPage, !0), a && a.categoryPageProducts && 0 < a.categoryPageProducts.length)) for (var c = 0; c < a.categoryPageProducts.length; c++) l(b, a.categoryPageProducts[c]) }, error: function () { } }) }, g.showRibbons()) })(window.nopProductRibbons = window.nopProductRibbons || {}, jQuery); $(document).on("nopAjaxFiltersFiltrationCompleteEvent", nopProductRibbons.showRibbons) });